data(baseball, package = "plyr")
head(baseball)
players <- unique(baseball$id)
head(players)
for i in players
print(unique(baseball$id))
for(i in players){
print(h/ab)
}
for(i in players){
print("h"/"ab")
}
for(i in players){
baseball$ba<-("h"/"ab")
}
sapply(baseball, class)
baseball$h <- as.numeric(as.integer(baseball$h))
baseball$ab <- as.numeric(as.integer(baseball$ab))
players <- unique(baseball$id)
for() i in players
print(unique(baseball$id))
for(i in players){
baseball$ba<-("h"/"ab")
}
baseball$h <- as.numeric(as.integer(baseball$h))
baseball$ab <- as.numeric(as.integer(baseball$ab))
players <- unique(baseball$id)
for(i in players){
baseball$ba<-("h"/"ab")
}
baseball$h <- as.numeric(as.integer(baseball$h))
baseball$ab <- as.numeric(as.integer(baseball$ab))
players <- unique(baseball$id)
for(i in players){
baseball$[ba]<-("h"/"ab")
}
baseball$h <- as.numeric(as.integer(baseball$h))
baseball$ab <- as.numeric(as.integer(baseball$ab))
players <- unique(baseball$id)
for(i in players){
baseball[ba]<-("h"/"ab")
}
baseball$h <- as.numeric(as.integer(baseball$h))
baseball$ab <- as.numeric(as.integer(baseball$ab))
players <- unique(baseball$id)
for(i in players){
baseball["ba"]<-("h"/"ab")
}
baseball$h <- as.numeric(as.integer(baseball$h))
baseball$ab <- as.numeric(as.integer(baseball$ab))
players <- unique(baseball$id)
for(i in players){
baseball["ba"]<-(players$h/players$ab)
}
baseball$ba <- for (i in sub){
print(mean(sub$h/sub$ab))
}
baseball$ba <- for (i in sub) {
print(mean(sub$h/sub$ab))
}
sub <- baseball[baseball$id == id, ]
#ba <- mean(sub$h/sub$ab)
baseball$ba <- for (i in sub) {
print(mean(sub$h/sub$ab))
}
players <- unique(baseball$id)
res <- data.frame(id = players,
ba = NA)
for(id in players){
sub <- baseball[baseball$id == id, ]
ba <- mean(sub$h/sun$ab)
res[res$id == id,]$ba <- ba
}
players <- unique(baseball$id)
res <- data.frame(id = players,
ba = NA)
for(id in players){
sub <- baseball[baseball$id == id, ]
ba <- mean(sub$h/sub$ab)
res[res$id == id,]$ba <- ba
}
View(res)
library('rvest')
url <- paste0(
"https://www.wunderground.com/history/airport/",
"KAMW/2016/11/15/DailyHistory.html"
)
weather_data <- read_html(url)
head(html_table(weather_data)[[1]])
library('rvest')
url <- paste0(
"https://www.wunderground.com/history/airport/",
"KIKV/2016/11/16/DailyHistory.html"
)
weather_data <- read_html(url)
head(html_table(weather_data)[[1]])
library("httr")
url <- "ftp://ftp.ncdc.noaa.gov/pub/data/noaa//isd-history.txt"
res <- GET(url, write_disk(path = basename(url)))
res$request$output$path
install.packages(httr)
install.packages("httr")
library("request")
library("dplyr")
res <- api("http://omdbapi.com") %>%
api_query(s = "robin hood", r = json)
res$Search
install.packages("httr")
install.packages("httr")
library("request")
library("dplyr")
res <- api("http://omdbapi.com") %>%
api_query(s = "robin hood", r = json)
res$Search
install.packages("request")
library("request")
library("dplyr")
res <- api("http://omdbapi.com") %>%
api_query(s = "robin hood", r = json)
res$Search
res <- api("http://omdbapi.com") %>%
api_query(s = "robin hood", r = json)
res$Search
url <- "https://images-na.ssl-images-amazon.com/images/M/MV5BMTg0OTg5MjExN15BMl5BanBnXkFtZTgwMjg3OTgzMTE@._V1_SX300.jpg"
res <- GET(url, write_disk(path = basename(url)))
res$request$output$path
library(tidyverse)
library(modelr)
options(na.action = na.warn)
ggplot(sim1, aes(x, y)) +
geom_point()
model1 <- function(a, data) {
a[1] + data$x * a[2]
}
model1(c(7, 1.5), sim1)
measure_distance <- function(mod, data) {
diff <- data$y - model1(mod, data)
sqrt(mean(diff ^ 2))
}
measure_distance(c(7, 1.5), sim1)
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
library(purrr)
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- model1 %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
library(tidyverse)
library(modelr)
library(purrr)
options(na.action = na.warn)
ggplot(sim1, aes(x, y)) +
geom_point()
model1 <- function(a, data) {
a[1] + data$x * a[2]
}
model1(c(7, 1.5), sim1)
measure_distance <- function(mod, data) {
diff <- data$y - model1(mod, data)
sqrt(mean(diff ^ 2))
}
measure_distance(c(7, 1.5), sim1)
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
install.packages("purrr")
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
install.packages("purrr")
library(tidyverse)
library(modelr)
library(purrr)
options(na.action = na.warn)
ggplot(sim1, aes(x, y)) +
geom_point()
model1 <- function(a, data) {
a[1] + data$x * a[2]
}
model1(c(7, 1.5), sim1)
measure_distance <- function(mod, data) {
diff <- data$y - model1(mod, data)
sqrt(mean(diff ^ 2))
}
measure_distance(c(7, 1.5), sim1)
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
install.packages("purrr")
install.packages("purrr")
library(tidyverse)
library(modelr)
library(purrr)
options(na.action = na.warn)
ggplot(sim1, aes(x, y)) +
geom_point()
model1 <- function(a, data) {
a[1] + data$x * a[2]
}
model1(c(7, 1.5), sim1)
measure_distance <- function(mod, data) {
diff <- data$y - model1(mod, data)
sqrt(mean(diff ^ 2))
}
measure_distance(c(7, 1.5), sim1)
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
models <- models %>% mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
sim1_dist <- function(a1, a2) {
measure_distance(c(a1, a2), sim1)
}
models <- models %>%
mutate(dist = purrr::map2_dbl(a1, a2, sim1_dist))
models
plot(sin(x)/(2x))
plot(sin(x)/(2x))
plot(cos, xlim = c(-pi,3*pi), n = 1001, col = "blue")
library("ggplot2")
eq = function(x){sin(x)/(2x)}
qplot(c(1,50), fun=eq, stat="function", geom="line", xlab="x", ylab="y")
library("ggplot2")
eq = function(x){sin(x)/(2x)}
eq = function(x){sin(x)/(2x))}
eq = function(x){sin(x)/(2x)}
eq = function(x){sin(x/2x)}
eq = function(x){sinx/2x)}
eq = function(x){sinx/(2x)}
getwd
getwd()
setwd("/Users/jaredflater/Google Drive/)
read.table <- "dna_standards_inc"
read.table <- "dna_standards_inc.csv"
library(readr)
dataset <- read_csv("Google Drive/dna_standards_inc.csv")
View(dataset)
library(readr)
dataset <- read_csv("Google Drive/dna_standards_inc.csv")
View(dataset)
plot(dataset$Concentration, dataset$Absorbance)
plot(dataset$Concentration, dataset$Absorbance,type = 1)
plot(dataset$Concentration, dataset$Absorbance,type = "1")
plot(dataset$Concentration, dataset$Absorbance)
plot(dataset$Concentration, dataset$Absorbance, labels(dataset$Plate))
lm(dataset$Absorbance ~ dataset$Concentration)
plot(lm(dataset$Absorbance ~ dataset$Concentration))
ggplot(data = dataset,aes(x=dataset$Concentration, y=dataset$Absorbance))
library(ggplot2)
ggplot(data = dataset,aes(x=dataset$Concentration, y=dataset$Absorbance))
ggplot(data = dataset,aes(x=dataset$Concentration, y=dataset$Absorbance)) +
geom_abline()
ggplot(data = dataset,aes(x=dataset$Concentration, y=dataset$Absorbance)) +
geom_dotplot()
ggplot(dataset, aes(dataset$Concentration, dataset$Absorbance)) +
geom_point(aes(color = dataset$Plate)) +
geom_smooth(method ="lm")
ggplot(dataset, aes(dataset$Concentration, dataset$Absorbance)) +
stat_smooth_func(geom="text",method="lm",hjust=0,parse=TRUE) +
geom_point() +
facet_wrap(~dataset$Plate) +
geom_smooth(method ="lm")
ggplot(dataset, aes(dataset$Concentration, dataset$Absorbance)) +
stat_smooth(geom="text",method="lm",hjust=0,parse=TRUE) +
geom_point() +
facet_wrap(~dataset$Plate) +
geom_smooth(method ="lm")
ggplot(dataset, aes(dataset$Concentration, dataset$Absorbance)) +
stat_smooth(method="lm",hjust=0,parse=TRUE) +
geom_point() +
facet_wrap(~dataset$Plate) +
geom_smooth(method ="lm")
knitr::opts_chunk$set(echo = TRUE)
#creating data dictionary
data_dictionary <- data.frame(
name = c("plot", "treatment", "sample_month", "sample_year", "crop" , "sample_block" , "agg_frac", "agrochem_addition", "crop_rot" , "land_use" , "veg_class" , "veg_class_meth" , "drain_class" , "extreme_event" , "FAO_class" , "fire_hist" , "soil_hor" , "soil_hor_meth" , "link_soil_method" , "soil_tax" , "soil_tax_meth", "pH" , "pH_meth" , "dna_mix" , "land_use_pre", "siev_size", "slope_grad" , "soil_type" , "soil_type_meth" , "store_cond" , "sand", "silt", "clay", "texture_meth" , "till" , "total_N" , "total_N_meth", "soil_water" , "soil_water_meth" , "total_C" , "misc_param_1" , "MBN_dry" , "MBN_applied" , "Ext_C_dry" , "Ext_C_applied" , "Ext_C_N_dry" , "Ext_N_applied" , "Bulk_dense" , "Ext_P_dry" , "AMF_col" , "AP_act" , "BG_act" , "BX_act" , "CB_act" , "NAG_act" , "Sum_C_act" , "MBC_dry" , "MBC_applied" , "MBC_MBN_meth" , "Ext_C_Ext_N_meth" , "AMF_col_meth" , "root_bm" , "root_dep" , "AMF_col_bm" , "MBC:MBN" , "MWD" , "agg_frac_prop" , "N2O_2011" , "CH4_2011" , "N2O_2012" , "CO2_2011" , "CO2_2012"),
column = c("Plot", "Treatment", "Sample Month", "Sample Year", "Crop", "Sample Block", "Aggregate Fraction", "Agrochemical Addition", "Crop Rotation", "Current Land Use", "Vegetation Class", "Vegetation Class Method", "Drainage Class", "Extreme Events", "FAO Soil Class", "Fire History", "Soil Horizon", "Soil Horizon Method", "Link to Soil Horizon Method", "Soil Taxonomy", "Soil Taxonomy Method", "pH", "pH Method", "Presence and Number of Mixed DNA Extractions", "Previous Land Use", "Size of Sieve", "Slope Gradient", "Soil Type", "Soil Type Method", "Condition of Stored Soil Sample", "Sand", "Silt", "Clay", "Soil Texture Method", "Tillage Type", "Total Nitrogen", "Total Nitrogen Method", "Soil Water Content", "Soil Water Content Method", "Total Carbon", "Miscellaneous Parameter 1", "Microbial Biomass Nitrogen Dry", "Microbial Biomass Nitrogen Applied", "Extractable Carbon Dry", "Extractable Carbon Applied", "Extractable Carbon and Nitrogen Dry", "Extractable Nitrogen Applied", "Bulk Density", "Extractable Phosphorous Dry", "AMF Colony", "Acid Phosphatase Activity", "$\\beta$-Glucosidase Activity", "$\\beta$-Xylosidase Activity", "Cellobiohyrolase Activity", "$\\beta$-N-acetylglucosaminidase Activity", "Sum Carbon Activity", "Microbial Biomass Carbon Dry", "Microbial Biomass Carbon Applied", "Microbial Carbon and Nitrogen Method", "Extractable Carbon and Nitrogen Analysis Method", "AMF Colony Method", "Root Biomass", "Root Depth", "AMF Colony Biomass", "Microbial Carbon:Microbial Nitrogen Ratio",	"Mean Weight Diameter", "Aggregate Fraction", "Nitrous Oxide Measurements 2011", "Methane Measurements 2011", "Nitrous Oxide Measurements 2012", "Carbon Dioxide Measurements 2011", "Carbon Dioxide Measurements 2012"),
description = c("Plot sample was taken from", "Treatment number plot received", "Month the sample was taken", "Year the sample was taken", "Cropping system", "Experimental block", "Fraction of aggregate", "Addition of fertilizers, pesticides, amount and time of applications", "Whether or not crop is rotated, and if yes, rotation schedule", "Current land use of sample site", "Vegetation classification", "Method of vegetation classification", "Drainage classification", "Unusual physical events that may have affected microbial populations", "Soil classification from the FAO World Reference Database for Soil Resources", "Historical and/or physical evidence of fire", "Layer of soil which exhibits physical characteristics that vary compared to the layers above and beneath", "Method used in determining the horizon", "Web link to digitized soil maps or other soil classification information", "Soil classification based on local soil classification system", "Method used in determining the local soil classification", "pH measurement", "Method for determining pH", "Number of mixed DNA extractions (string(???)) Only one DNA extraction used (no)", "Previous land use and dates of recorded history", "Size of sieve in millimeters", "The angle between ground surface and a horizontal line in percent", "Soil series name or other lower-level classification", "Method used in determining soil series name or other lower-level classification", "How and for how long the soil sample was stored before DNA extraction", "Relative proportion of percent sand (50 um to 2 mm)", "Relative proportion of silt (2 um to 50 um)", "Relative proportion of clay (<2 um)", "Method used in determining soil texture", "Method used for tilling", "Total nitrogen content of the soil in grams of Nitrogen per kilogram of soil", "Method used in determining the total Nitrogen", "Water content (g/g or cm3/cm3) in soil", "Method used in determining the water content of soil", "Total Carbon in mg/g", "Any other measurement performed or parameter collected that is not listed here", "Amount of Nitrogen in the microbial biomass in micrograms of Nitrogen per 1 gram of dry soil", "CFE	MBN gN m-2", "Extractable Carbon in micrograms of Carbon per gram of dry soil", "Extractable Carbon in grams of Carbon per square meter","Extractable Carbon in micrograms of Nitrogen per gram of dry soil", "Extractable Nitrogen in grams of Carbon per square meter", "Bulk density in grams per cubed centimeter", "Extractable Phosphorous using Bray's extraction method in milligras per kilogram of dry soil", "Percentage of Community of arbuscular mycorrhizal fungi", "Acid Phosphatase (AP) Activity in nanomoles of hydrogen per gram of dry aggregate", "$\\beta$-Glucosidase (BG) Activity in nanomoles of hydrogen per gram of dry aggregate", "$\\beta$-Xylosidase (BX) Activity in nanomoles of hydrogen per gram of dry aggregate", "Cellobiohyrolase (CB) Activity in nanomoles of hydrogen per gram of dry aggregate", "$\\beta$-N-acetylglucosaminidase (NAG) Activity in nanomoles of hydrogen per gram of dry aggregate", "Sum of Carbon activity in nanomoles of hydrogen per gram of dry aggregate", "BG + BX + CB	MBC ugC g-1 dry soil CFE", "MBC gC m-2 CFE", "Method for Carbon and Nitrogen analysis in microbial", "Method for extractable Carbon and Nitrogen analysis", "Method for Community of arbuscular mycorrhizal fungi", "Amount of root biomass in megagrams per hectare", "Depth of roots in centimeters", "Biomass of Community of arbuscular mycorrhizal fungi", "Ratio of microbial biomass carbon to nitrogen",	"Mean Weight Diameter in micromoles", "Proportion of aggregate fraction", "Nitrous Oxide Measurements 2011 in micromoles per square meter", "Methane Measurements 2011 in micromoles per square meter", "Nitrous Oxide Measurements 2012 in micromoles per square meter", "Carbon Dioxide Measurements 2011 in micromoles per square meter", "Carbon Dioxide Measurements 2012 in micromoles per square meter"))
knitr::kable(data_dictionary)
BG_abun=read.table("data/summary_counts/summary_count_3.2.1.21.fasta.tsv",header=T)
BG_abun=read.table("data/summary_counts/summary_count_3.2.1.21.fasta.tsv",header=T)
BX_abun=read.table("data/summary_counts/summary_count_3.2.1.37.fasta.tsv",header=T)
BX_abun=read.table("data/summary_counts/summary_count_3.2.1.37.fasta.tsv",header=T)
CB_abun=read.table("data/summary_counts/summary_count_3.2.1.91.fasta.tsv",header=T)
BG_abun=read.table("data/summary_counts/summary_count_3.2.1.21.fasta.tsv",header=T)
BX_abun=read.table("data/summary_counts/summary_count_3.2.1.37.fasta.tsv",header=T)
CB_abun=read.table("data/summary_counts/summary_count_3.2.1.91.fasta.tsv",header=T)
smplnk=read.csv("data/SampleLink5.csv")
BG.t=data.frame(t(BG_abun))
View(BG.t)
View(smplnk)
View(BG_abun)
View(BG.t)
meta=read.csv("Tidy_Cobs.csv")
View(meta)
View(BG_abun)
View(meta)
View(smplnk)
BG_abun=read.table("data/summary_counts/summary_count_3.2.1.21.fasta.tsv",header=T)
BX_abun=read.table("data/summary_counts/summary_count_3.2.1.37.fasta.tsv",header=T)
CB_abun=read.table("data/summary_counts/summary_count_3.2.1.91.fasta.tsv",header=T)
meta=read.csv("Tidy_Cobs.csv")
smplnk=read.csv("data/SampleLink5.csv")
BG.t=data.frame(t(BG_abun))
BG.t$row=row.names(BG.t)
BG.t$row=gsub("_R1", "", BG.t$row)
BG.t$row=gsub("_R2", "", BG.t$row)
BX.t=data.frame(t(BX_abun))
BX.t$row=row.names(BX.t)
BX.t$row=gsub("_R1", "", BX.t$row)
BX.t$row=gsub("_R2", "", BX.t$row)
CB.t=data.frame(t(CB_abun))
CB.t$row=row.names(CB.t)
CB.t$row=gsub("_R1", "", CB.t$row)
CB.t$row=gsub("_R2", "", CB.t$row)
meta$agg_frac<-gsub("micro", "Micro", meta$agg_frac)
meta$group<-paste(meta$treatment, meta$plot, sep="")
meta$myear<-paste(meta$sample_month, meta$sample_year, sep="")
meta$SampleName<-paste(meta$group, meta$agg_frac, meta$myear, sep="-")
smplnkBG=merge(BG.t,smplnk,by.x="row",by.y="rast_file")
smplnkBX=merge(BX.t,smplnk,by.x="row",by.y="rast_file")
smplnkCB=merge(CB.t,smplnk,by.x="row",by.y="rast_file")
mergedataBG=merge(meta,smplnkBG, by.x = "SampleName", by.y = "SampleName")
mergedataBX=merge(meta,smplnkBX, by.x = "SampleName", by.y = "SampleName")
mergedataCB=merge(meta,smplnkCB, by.x = "SampleName", by.y = "SampleName")
library(DESeq2)
library(DESeq2)
x <- mergedataBG
View(mergedataBG)
getwd()
setwd("/Users/jaredflater/Documents/agron560_data_management/AGRON-590-Project/data/summary_counts")
knitr::opts_chunk$set(echo = TRUE)
#creating data dictionary
data_dictionary <- data.frame(
name = c("plot", "treatment", "sample_month", "sample_year", "crop" , "sample_block" , "agg_frac", "agrochem_addition", "crop_rot" , "land_use" , "veg_class" , "veg_class_meth" , "drain_class" , "extreme_event" , "FAO_class" , "fire_hist" , "soil_hor" , "soil_hor_meth" , "link_soil_method" , "soil_tax" , "soil_tax_meth", "pH" , "pH_meth" , "dna_mix" , "land_use_pre", "siev_size", "slope_grad" , "soil_type" , "soil_type_meth" , "store_cond" , "sand", "silt", "clay", "texture_meth" , "till" , "total_N" , "total_N_meth", "soil_water" , "soil_water_meth" , "total_C" , "misc_param_1" , "MBN_dry" , "MBN_applied" , "Ext_C_dry" , "Ext_C_applied" , "Ext_C_N_dry" , "Ext_N_applied" , "Bulk_dense" , "Ext_P_dry" , "AMF_col" , "AP_act" , "BG_act" , "BX_act" , "CB_act" , "NAG_act" , "Sum_C_act" , "MBC_dry" , "MBC_applied" , "MBC_MBN_meth" , "Ext_C_Ext_N_meth" , "AMF_col_meth" , "root_bm" , "root_dep" , "AMF_col_bm" , "MBC:MBN" , "MWD" , "agg_frac_prop" , "N2O_2011" , "CH4_2011" , "N2O_2012" , "CO2_2011" , "CO2_2012"),
column = c("Plot", "Treatment", "Sample Month", "Sample Year", "Crop", "Sample Block", "Aggregate Fraction", "Agrochemical Addition", "Crop Rotation", "Current Land Use", "Vegetation Class", "Vegetation Class Method", "Drainage Class", "Extreme Events", "FAO Soil Class", "Fire History", "Soil Horizon", "Soil Horizon Method", "Link to Soil Horizon Method", "Soil Taxonomy", "Soil Taxonomy Method", "pH", "pH Method", "Presence and Number of Mixed DNA Extractions", "Previous Land Use", "Size of Sieve", "Slope Gradient", "Soil Type", "Soil Type Method", "Condition of Stored Soil Sample", "Sand", "Silt", "Clay", "Soil Texture Method", "Tillage Type", "Total Nitrogen", "Total Nitrogen Method", "Soil Water Content", "Soil Water Content Method", "Total Carbon", "Miscellaneous Parameter 1", "Microbial Biomass Nitrogen Dry", "Microbial Biomass Nitrogen Applied", "Extractable Carbon Dry", "Extractable Carbon Applied", "Extractable Carbon and Nitrogen Dry", "Extractable Nitrogen Applied", "Bulk Density", "Extractable Phosphorous Dry", "AMF Colony", "Acid Phosphatase Activity", "$\\beta$-Glucosidase Activity", "$\\beta$-Xylosidase Activity", "Cellobiohyrolase Activity", "$\\beta$-N-acetylglucosaminidase Activity", "Sum Carbon Activity", "Microbial Biomass Carbon Dry", "Microbial Biomass Carbon Applied", "Microbial Carbon and Nitrogen Method", "Extractable Carbon and Nitrogen Analysis Method", "AMF Colony Method", "Root Biomass", "Root Depth", "AMF Colony Biomass", "Microbial Carbon:Microbial Nitrogen Ratio",	"Mean Weight Diameter", "Aggregate Fraction", "Nitrous Oxide Measurements 2011", "Methane Measurements 2011", "Nitrous Oxide Measurements 2012", "Carbon Dioxide Measurements 2011", "Carbon Dioxide Measurements 2012"),
description = c("Plot sample was taken from", "Treatment number plot received", "Month the sample was taken", "Year the sample was taken", "Cropping system", "Experimental block", "Fraction of aggregate", "Addition of fertilizers, pesticides, amount and time of applications", "Whether or not crop is rotated, and if yes, rotation schedule", "Current land use of sample site", "Vegetation classification", "Method of vegetation classification", "Drainage classification", "Unusual physical events that may have affected microbial populations", "Soil classification from the FAO World Reference Database for Soil Resources", "Historical and/or physical evidence of fire", "Layer of soil which exhibits physical characteristics that vary compared to the layers above and beneath", "Method used in determining the horizon", "Web link to digitized soil maps or other soil classification information", "Soil classification based on local soil classification system", "Method used in determining the local soil classification", "pH measurement", "Method for determining pH", "Number of mixed DNA extractions (string(???)) Only one DNA extraction used (no)", "Previous land use and dates of recorded history", "Size of sieve in millimeters", "The angle between ground surface and a horizontal line in percent", "Soil series name or other lower-level classification", "Method used in determining soil series name or other lower-level classification", "How and for how long the soil sample was stored before DNA extraction", "Relative proportion of percent sand (50 um to 2 mm)", "Relative proportion of silt (2 um to 50 um)", "Relative proportion of clay (<2 um)", "Method used in determining soil texture", "Method used for tilling", "Total nitrogen content of the soil in grams of Nitrogen per kilogram of soil", "Method used in determining the total Nitrogen", "Water content (g/g or cm3/cm3) in soil", "Method used in determining the water content of soil", "Total Carbon in mg/g", "Any other measurement performed or parameter collected that is not listed here", "Amount of Nitrogen in the microbial biomass in micrograms of Nitrogen per 1 gram of dry soil", "CFE	MBN gN m-2", "Extractable Carbon in micrograms of Carbon per gram of dry soil", "Extractable Carbon in grams of Carbon per square meter","Extractable Carbon in micrograms of Nitrogen per gram of dry soil", "Extractable Nitrogen in grams of Carbon per square meter", "Bulk density in grams per cubed centimeter", "Extractable Phosphorous using Bray's extraction method in milligras per kilogram of dry soil", "Percentage of Community of arbuscular mycorrhizal fungi", "Acid Phosphatase (AP) Activity in nanomoles of hydrogen per gram of dry aggregate", "$\\beta$-Glucosidase (BG) Activity in nanomoles of hydrogen per gram of dry aggregate", "$\\beta$-Xylosidase (BX) Activity in nanomoles of hydrogen per gram of dry aggregate", "Cellobiohyrolase (CB) Activity in nanomoles of hydrogen per gram of dry aggregate", "$\\beta$-N-acetylglucosaminidase (NAG) Activity in nanomoles of hydrogen per gram of dry aggregate", "Sum of Carbon activity in nanomoles of hydrogen per gram of dry aggregate", "BG + BX + CB	MBC ugC g-1 dry soil CFE", "MBC gC m-2 CFE", "Method for Carbon and Nitrogen analysis in microbial", "Method for extractable Carbon and Nitrogen analysis", "Method for Community of arbuscular mycorrhizal fungi", "Amount of root biomass in megagrams per hectare", "Depth of roots in centimeters", "Biomass of Community of arbuscular mycorrhizal fungi", "Ratio of microbial biomass carbon to nitrogen",	"Mean Weight Diameter in micromoles", "Proportion of aggregate fraction", "Nitrous Oxide Measurements 2011 in micromoles per square meter", "Methane Measurements 2011 in micromoles per square meter", "Nitrous Oxide Measurements 2012 in micromoles per square meter", "Carbon Dioxide Measurements 2011 in micromoles per square meter", "Carbon Dioxide Measurements 2012 in micromoles per square meter"))
knitr::kable(data_dictionary)
BG_abun=read.table("data/summary_counts/summary_count_3.2.1.21.fasta.tsv",header=T)
BX_abun=read.table("data/summary_counts/summary_count_3.2.1.37.fasta.tsv",header=T)
CB_abun=read.table("data/summary_counts/summary_count_3.2.1.91.fasta.tsv",header=T)
View(CB_abun)
View(CB_abun)
head(CB_abun)
BG_abun=read.table("data/summary_counts/3.2.1.21.fasta.summary_count.tsv",header=T)
BX_abun=read.table("data/summary_counts/3.2.1.37.fasta.summary_count.tsv",header=T)
CB_abun=read.table("data/summary_counts/3.2.1.91.fasta.summary_count.tsv",header=T)
View(BG_abun)
BG_abun=read.table("data/summary_counts/3.2.1.21.fasta.summary_count.tsv",header=T)
BX_abun=read.table("data/summary_counts/3.2.1.37.fasta.summary_count.tsv",header=T)
CB_abun=read.table("data/summary_counts/3.2.1.91.fasta.summary_count.tsv",header=T)
meta=read.csv("Tidy_Cobs.csv")
smplnk=read.csv("data/SampleLink5.csv")
BG_abun=read.table("data/summary_counts/3.2.1.21.fasta.summary_count.tsv",header=T)
BX_abun=read.table("data/summary_counts/3.2.1.37.fasta.summary_count.tsv",header=T)
CB_abun=read.table("data/summary_counts/3.2.1.91.fasta.summary_count.tsv",header=T)
meta=read.csv("Tidy_Cobs.csv")
smplnk=read.csv("data/SampleLink5.csv")
View(meta)
View(smplnk)
BG.t=data.frame(t(BG_abun))
View(BG.t)
BG.t$row=row.names(BG.t)
head(BG.t$row)
BG.t$row=gsub("_R1", "", BG.t$row)
head(BG.t$row)
BG.t$row=gsub("_R2", "", BG.t$row)
head(BG.t$row)
BX.t=data.frame(t(BX_abun))
BX.t$row=row.names(BX.t)
BX.t$row=gsub("_R1", "", BX.t$row)
BX.t$row=gsub("_R2", "", BX.t$row)
CB.t=data.frame(t(CB_abun))
CB.t$row=row.names(CB.t)
CB.t$row=gsub("_R1", "", CB.t$row)
CB.t$row=gsub("_R2", "", CB.t$row)
meta$agg_frac<-gsub("micro", "Micro", meta$agg_frac)
meta$group<-paste(meta$treatment, meta$plot, sep="")
meta$myear<-paste(meta$sample_month, meta$sample_year, sep="")
meta$SampleName<-paste(meta$group, meta$agg_frac, meta$myear, sep="-")
smplnkBG=merge(BG.t,smplnk,by.x="row",by.y="filename")
View(smplnkBG)
head(smplnkBG)
smplnkBG[1:10,3770:3776]
smplnkBX=merge(BX.t,smplnk,by.x="row",by.y="filename")
smplnkCB=merge(CB.t,smplnk,by.x="row",by.y="filename")
mergedataBG=merge(meta,smplnkBG, by.x = "SampleName", by.y = "SampleName")
mergedataBX=merge(meta,smplnkBX, by.x = "SampleName", by.y = "SampleName")
mergedataCB=merge(meta,smplnkCB, by.x = "SampleName", by.y = "SampleName")
smplnk=read.csv("data/SampleLink5.csv")
meta$agg_frac<-gsub("micro", "Micro", meta$agg_frac)
meta$group<-paste(meta$treatment, meta$plot, sep="")
meta$myear<-paste(meta$sample_month, meta$sample_year, sep="")
meta$SampleName<-paste(meta$group, meta$agg_frac, meta$myear, sep="-")
smplnkBG=merge(BG.t,smplnk,by.x="row",by.y="filename")
smplnkBX=merge(BX.t,smplnk,by.x="row",by.y="filename")
smplnkCB=merge(CB.t,smplnk,by.x="row",by.y="filename")
mergedataBG=merge(meta,smplnkBG, by.x = "SampleName", by.y = "SampleName")
mergedataBX=merge(meta,smplnkBX, by.x = "SampleName", by.y = "SampleName")
mergedataCB=merge(meta,smplnkCB, by.x = "SampleName", by.y = "SampleName")
View(mergedataCB)
library(DESeq2)
x <- mergedataBG
countData <- t(x[,(ncol(meta)+2):(ncol(x)-(ncol(smplnk)-2) )])
colData <- x[,1:(ncol(meta))]
deseq2_deseqds <- DESeqDataSetFromMatrix(countData = countData, colData = colData, design = ~agg_frac)
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
geoMeans = apply(counts(deseq2_deseqds), 1, gm_mean)
dds = estimateSizeFactors(deseq2_deseqds, geoMeans = geoMeans)
View(colData)
View(countData)
x <- mergedataBG
x <- mergedataBX
x <- mergedataCB
countData <- t(x[,(ncol(meta)+2):(ncol(x)-(ncol(smplnk)-2) )])
colData <- x[,1:(ncol(meta))]
deseq2_deseqds <- DESeqDataSetFromMatrix(countData = countData, colData = colData, design = ~agg_frac)
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
geoMeans = apply(counts(deseq2_deseqds), 1, gm_mean)
dds = estimateSizeFactors(deseq2_deseqds, geoMeans = geoMeans)
gm_mean = function(x, na.rm=TRUE){
exp(sum(log(x[x > 0]), na.rm=na.rm) / length(x))
}
geoMeans = apply(counts(deseq2_deseqds), 1, gm_mean)
dds = estimateSizeFactors(deseq2_deseqds, geoMeans = geoMeans)
countData <- t(x[,(ncol(meta)+2):(ncol(x)-(ncol(smplnk)-2) )])
colData <- x[,1:(ncol(meta))]
deseq2_deseqds <- DESeqDataSetFromMatrix(countData = countData, colData = colData, design = ~agg_frac)
dds = estimateSizeFactors(deseq2_deseqds, geoMeans = geoMeans)
deseq2_de = DESeq(dds, fitType="local")
View(x)
View(x)
View(x)
